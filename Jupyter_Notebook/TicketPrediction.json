{"paragraphs":[{"text":"%pyspark\nfrom pyspark.ml import Pipeline\nfrom pyspark.ml.classification import GBTClassifier\nfrom pyspark.ml.feature import StringIndexer, VectorIndexer\nfrom pyspark.ml.evaluation import MulticlassClassificationEvaluator\n\nPATH = 'file:///Users/zacha/Desktop/Projects/TicketPrediction/'\n\n#load the data\ntraining_df = spark.read.format('csv').load(PATH + 'TRAINING_Traffic_Stops__drivers.csv')\n\n# Features Data Frame Columns\n#   Address (Road)\n#   Action Taken Id (Citation | No Citation)\n#   Date (Time) \n#   Vehicle Make \n#   Vehicle Model \n#   Vehicle Year \n#   License Plate State \n#   Sex \n#   Race \n#   Age range\nfeatureFrame = (\n    training_df\n        .withColumn(\"Road\",regexp_extract($\"ADDRESS_X\",(\"X\\s([A-Z0-9\\s]+)^\"),1))\n)\n","user":"anonymous","dateUpdated":"2017-08-26T23:09:21-0400","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Row(_c0='ADDRESS_X', _c1='LATITUDE_X', _c2='LONGITUDE_X', _c3='AGENCY', _c4='DISPOSITION_TEXT', _c5='EVENT_NUMBER', _c6='INCIDENT_TYPE_DESC', _c7='INCIDENT_TYPE_ID', _c8='ACTIONTAKENCID', _c9='ACTIONTAKENCIDID', _c10='NEIGHBORHOOD', _c11='PRIORITY_', _c12='INSTANCE_ID', _c13='IS_JUVENILE', _c14='INTERVIEW_NUMBER', _c15='INTERVIEW_DATE', _c16='VEHICLE_MAKE', _c17='VEHICLE_MODEL', _c18='VEHICLE_YEAR', _c19='CONTACT_TYPE_CID', _c20='LICENSE_PLATE_STATE', _c21='OFFICER_ASSIGNMENT', _c22='REPORT_TYPE_CID', _c23='SEX', _c24='RACE', _c25='AGE', _c26='FIELD_SUBJECT_CID', _c27='AGE_RANGE_CID', _c28='BEAT')\nRow(_c0='35XX MONTGOMERY RD', _c1='39.14357244', _c2='-84.47090999', _c3='CP', _c4='CITED', _c5='LCP150430001201', _c6='TRAFFIC STOP', _c7='TS', _c8='CITATION TRAFFIC', _c9='3', _c10=None, _c11='5', _c12='{EBD2DFF4-785B-468B-A34A-377EBEAF5A91}', _c13='No', _c14='15-108819', _c15='04/30/2015 05:23:00 PM +0000', _c16='NISS', _c17='MAXI', _c18='2011', _c19='1 - MOTOR VEHICLE', _c20='OHIO', _c21='DISTRICT 2', _c22='CC - CONTACT CARD', _c23='MALE', _c24='BLACK', _c25='30', _c26='DRIVER', _c27='26-35', _c28='P211')\nRow(_c0='12XX W 6TH ST', _c1='-0.00006', _c2='-0.00006', _c3='CP', _c4='CITED', _c5='LCP161227001230', _c6='TRAFFIC STOP', _c7='TS', _c8='WARNING', _c9='2', _c10=None, _c11='5', _c12='{88320FDE-CB1E-4C36-938F-6285ED9DE808}', _c13='No', _c14='16-125984', _c15='12/27/2016 09:11:00 PM +0000', _c16='VOLK', _c17='JETT', _c18='2014', _c19='MOTOR VEHICLE', _c20='OHIO', _c21='TRAFFIC UNIT', _c22='CONTACT CARD', _c23='MALE', _c24='WHITE', _c25='40', _c26='DRIVER', _c27='36-45', _c28='P132')\nRow(_c0='35XX READING RD', _c1='39.14383019', _c2='-84.49044521', _c3='CP', _c4='NOTHING TO REPORT', _c5='LCP151105001082', _c6='SPECIAL DETAIL', _c7='SDET', _c8='WARNING', _c9='2', _c10=None, _c11='8', _c12='{FC46E792-01FE-48D2-BBB3-ABD7B1559906}', _c13='No', _c14='15-124422', _c15='11/05/2015 04:40:00 PM +0000', _c16='TOYT', _c17='CORO', _c18='2009', _c19='MOTOR VEHICLE', _c20='OHIO', _c21='DISTRICT 4', _c22='CONTACT CARD', _c23='FEMALE', _c24='BLACK', _c25='34', _c26='DRIVER', _c27='26-35', _c28='P434')\nRow(_c0='61XX CORBLY ST', _c1='39.09436004', _c2='-84.38746986', _c3='CP', _c4='CITED', _c5='LCP160225000939', _c6='TRAFFIC STOP', _c7='TS', _c8='CITATION TRAFFIC', _c9='3', _c10=None, _c11='5', _c12='{52120CFD-D66F-4E97-BAFC-3DA7EB9BFAAE}', _c13='No', _c14='16-100416', _c15='02/25/2016 04:35:00 PM +0000', _c16='HYUN', _c17='ELAN', _c18='2002', _c19='MOTOR VEHICLE', _c20='OHIO', _c21='DISTRICT 2', _c22='CONTACT CARD', _c23='MALE', _c24='WHITE', _c25='24', _c26='DRIVER', _c27='18-25', _c28='P246')\nRow(_c0='42XX SPRING GROVE AV', _c1='39.16066724', _c2='-84.52979378', _c3='CP', _c4='CONTACT CARD', _c5='LCP160528000091', _c6='TRAFFIC STOP', _c7='TS', _c8='WARNING', _c9='2', _c10=None, _c11='5', _c12='{439829DD-BCEB-410E-8A99-4F92F57AD012}', _c13='No', _c14='16-113764', _c15='05/28/2016 01:03:00 AM +0000', _c16='CADI', _c17='DEVI', _c18='1988', _c19='MOTOR VEHICLE', _c20='OHIO', _c21='DISTRICT 5', _c22='CONTACT CARD', _c23='MALE', _c24='BLACK', _c25='77', _c26='DRIVER', _c27='46+', _c28='P531')\nRow(_c0='9XX ROGERS PL', _c1='39.12306311', _c2='-84.49023023', _c3='CP', _c4='ARREST', _c5='LCP160702000056', _c6='TRAFFIC STOP', _c7='TS', _c8='CITATION TRAFFIC', _c9='3', _c10=None, _c11='5', _c12='{B0668BCD-05CD-479F-A230-778B33AC0B61}', _c13='No', _c14='16-116071', _c15='07/02/2016 12:25:00 AM +0000', _c16='BUICK', _c17='LE SABRE', _c18='2003', _c19='MOTOR VEHICLE', _c20='OHIO', _c21='DISTRICT 4', _c22='CONTACT CARD', _c23='MALE', _c24='BLACK', _c25='60', _c26='DRIVER', _c27='46+', _c28='P423')\nRow(_c0='8XX LEXINGTON AV', _c1='39.1461004', _c2='-84.48706443', _c3='CP', _c4='ARREST', _c5='LCP150527001457', _c6='TRAFFIC STOP', _c7='TS', _c8='CITATION TRAFFIC', _c9='3', _c10=None, _c11='5', _c12='{48ED8F58-C817-4716-A113-BF51690BACCF}', _c13='No', _c14='15-111107', _c15='05/27/2015 06:19:00 PM +0000', _c16='CHEV', _c17='CAVL', _c18='1999', _c19='MOTOR VEHICLE', _c20='OHIO', _c21='DISTRICT 4', _c22='CONTACT CARD', _c23='MALE', _c24='BLACK', _c25='35', _c26='DRIVER', _c27='26-35', _c28='P434')\nRow(_c0='37XX CLIFTON AV', _c1='39.15262513', _c2='-84.51852379', _c3='CP', _c4='CITED', _c5='LCP170106001435', _c6='TRAFFIC STOP', _c7='TS', _c8=None, _c9=None, _c10=None, _c11='5', _c12='{941889DB-457B-4EF9-B1D8-731FC895CFE5}', _c13='No', _c14='17-100274', _c15='01/06/2017 10:45:00 PM +0000', _c16='CHEV', _c17='MALI', _c18='1999', _c19='MOTOR VEHICLE', _c20='OHIO', _c21='DISTRICT 5', _c22='CONTACT CARD', _c23='MALE', _c24='BLACK', _c25='23', _c26='DRIVER', _c27='18-25', _c28='P528')\nRow(_c0='1XX MULBERRY ST', _c1='39.11594953', _c2='-84.51358923', _c3='CP', _c4='CITED', _c5='LCP150427001608', _c6='TRAFFIC STOP', _c7='TS', _c8='CITATION TRAFFIC', _c9='3', _c10=None, _c11='5', _c12='{064092F5-81B9-4F89-8BFC-F3095588A5DD}', _c13='No', _c14='15-108317', _c15='04/27/2015 09:31:00 PM +0000', _c16='CHRY', _c17='SEBR', _c18='2007', _c19='1 - MOTOR VEHICLE', _c20='OHIO', _c21='COMMUNITY RELATIONS UNIT', _c22='CC - CONTACT CARD', _c23='FEMALE', _c24='BLACK', _c25='38', _c26='DRIVER', _c27='36-45', _c28='P411')\n"}]},"apps":[],"jobName":"paragraph_1503798307334_556390656","id":"20170826-214507_1908324424","dateCreated":"2017-08-26T21:45:07-0400","dateStarted":"2017-08-26T22:50:32-0400","dateFinished":"2017-08-26T22:50:34-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:254"},{"text":"%pyspark\n","user":"anonymous","dateUpdated":"2017-08-26T22:26:09-0400","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1503800769383_994532044","id":"20170826-222609_904774148","dateCreated":"2017-08-26T22:26:09-0400","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:255"}],"name":"TicketPrediction","id":"2CSRQRET3","angularObjects":{"2CTQA8H9H:shared_process":[],"2CS12W3HZ:shared_process":[],"2CRB9NP2H:shared_process":[],"2CSTGQ6B9:shared_process":[],"2CTH8QUU8:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}